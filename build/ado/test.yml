# yaml-language-server: $schema=https://raw.githubusercontent.com/microsoft/azure-pipelines-vscode/main/service-schema.json

trigger: 
  branches:
    include:
      - main

pool:
  vmImage: ubuntu-latest

jobs:
  - job: test
    steps:
      - pwsh: 'npm install -g pnpm'
        displayName: install pnpm
        
      - pwsh: 'pnpm install'
        displayName: pnpm install

      - pwsh: 'pnpm test:ci'
        displayName: run tests
        
      - task: PublishCodeCoverageResults@1
        inputs:
          codeCoverageTool: 'Cobertura'
          summaryFileLocation: 'coverage/cobertura-coverage.xml'
        displayName: 'Publish Code Coverage'